<?php

/**
 * ## Test of all models defined
 *
 * ------
 *
 * This file is auto-generated by: Workbench\App\Console\Commands\RunTestProjectManagerCommand
 * rewrite this test-file on the console with: php artisan run:test-project
 */

namespace SchenkeIo\LaravelRelationManager\Tests\Application;

use Illuminate\Foundation\Testing\RefreshDatabase;
use SchenkeIo\LaravelRelationManager\Phpunit\AssertModelRelations;
use SchenkeIo\LaravelRelationManager\Tests\TestCase;
use Workbench\App\Console\Commands\RunTestProjectManagerCommand;

class TestProjectTest extends TestCase
{
    use RefreshDatabase;
    use AssertModelRelations;

    /**
     * @return void
     * @group GenerateProjectTestFile
     *
     * Since this class is written by the Command file Workbench\App\Console\Commands\RunTestProjectManagerCommand
     * it is risky when changes in the Command file are not transferred here
     * To update this file just run: php artisan run:test-project
     */
    public function testCommandFileIsOlderThanThisTestFile(): void
    {
        $this->assertFirstClassIsOlderThanSecondClass(
            RunTestProjectManagerCommand::class,
            __CLASS__
        );
    }

    /**
     * Model Workbench\App\Models\Capital
     * @group GenerateProjectTestFile
     */
    public function testModelCapitalHas_2StrictRelationshipsAndWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\Capital");
        $this->assertModelBelongsTo('Workbench\App\Models\Capital', 'Workbench\App\Models\Country');
        $this->assertModelMorphOne('Workbench\App\Models\Capital', 'Workbench\App\Models\Location');
        $this->assertModelRelationCount('Workbench\App\Models\Capital', 2);
    }

    /**
     * Model Workbench\App\Models\City
     * @group GenerateProjectTestFile
     */
    public function testModelCityHas_5StrictRelationshipsAndWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\City");
        $this->assertModelIsManyToMany('Workbench\App\Models\City', 'Workbench\App\Models\Highway');
        $this->assertModelMorphOne('Workbench\App\Models\City', 'Workbench\App\Models\Location');
        $this->assertModelHasOneThrough('Workbench\App\Models\City', 'Workbench\App\Models\Country');
        $this->assertModelCastEnum('Workbench\App\Models\City', 'Workbench\App\Models\Size');
        $this->assertModelBelongsTo('Workbench\App\Models\City', 'Workbench\App\Models\Region');
        $this->assertModelRelationCount('Workbench\App\Models\City', 5);
    }

    /**
     * Model Workbench\App\Models\Country
     * @group GenerateProjectTestFile
     */
    public function testModelCountryHas_3StrictRelationshipsAndWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\Country");
        $this->assertModelHasOne('Workbench\App\Models\Country', 'Workbench\App\Models\Capital');
        $this->assertModelHasMany('Workbench\App\Models\Country', 'Workbench\App\Models\Region');
        $this->assertModelHasManyThrough('Workbench\App\Models\Country', 'Workbench\App\Models\City');
        $this->assertModelRelationCount('Workbench\App\Models\Country', 3);
    }

    /**
     * Model Workbench\App\Models\Highway
     * @group GenerateProjectTestFile
     */
    public function testModelHighwayHas_2StrictRelationshipsAndWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\Highway");
        $this->assertModelBelongsToMany('Workbench\App\Models\Highway', 'Workbench\App\Models\City');
        $this->assertModelMorphMany('Workbench\App\Models\Highway', 'Workbench\App\Models\Location');
        $this->assertModelRelationCount('Workbench\App\Models\Highway', 2);
    }

    /**
     * Model Workbench\App\Models\Location
     * @group GenerateProjectTestFile
     */
    public function testModelLocationHas_1StrictRelationshipAndWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\Location");
        $this->assertModelMorphTo('Workbench\App\Models\Location');
        $this->assertModelRelationCount('Workbench\App\Models\Location', 1);
    }

    /**
     * Model Workbench\App\Models\Region
     * @group GenerateProjectTestFile
     */
    public function testModelRegionHas_3StrictRelationshipsAndWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\Region");
        $this->assertModelBelongsTo('Workbench\App\Models\Region', 'Workbench\App\Models\Country');
        $this->assertModelHasMany('Workbench\App\Models\Region', 'Workbench\App\Models\City');
        $this->assertModelHasOneThrough('Workbench\App\Models\Region', 'Workbench\App\Models\Capital');
        $this->assertModelRelationCount('Workbench\App\Models\Region', 3);
    }

    /**
     * Model Workbench\App\Models\Single
     * @group GenerateProjectTestFile
     */
    public function testModelSingleHas_0StrictRelationshipsAndWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\Single");
        $this->assertModelRelationCount('Workbench\App\Models\Single', 0);
    }

    /**
     * Enum Workbench\App\Models\Size
     * @group GenerateProjectTestFile
     */
    public function testBackedEnumSizeWorks(): void
    {
        $this->assertModelBackedEnumWorks("Workbench\App\Models\Size");
    }
}
